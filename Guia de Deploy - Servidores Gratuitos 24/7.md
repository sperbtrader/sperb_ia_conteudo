# Guia de Deploy - Servidores Gratuitos 24/7

Este guia apresenta v√°rias op√ß√µes de servidores gratuitos para hospedar o sistema de gera√ß√£o de conte√∫do sobre day trade.

## Op√ß√µes de Hospedagem Gratuita

### 1. Railway (Recomendado)

**Vantagens:**
- Deploy autom√°tico via GitHub
- 500 horas gratuitas por m√™s
- Suporte nativo ao Docker
- F√°cil configura√ß√£o de vari√°veis de ambiente

**Limita√ß√µes:**
- Ap√≥s 500 horas, o servi√ßo para at√© o pr√≥ximo m√™s
- Recursos limitados (512MB RAM, 1 vCPU)

**Passos para Deploy:**

1. **Preparar Reposit√≥rio GitHub**
   ```bash
   git init
   git add .
   git commit -m "Initial commit"
   git branch -M main
   git remote add origin https://github.com/seu-usuario/day-trade-generator.git
   git push -u origin main
   ```

2. **Configurar Railway**
   - Acesse [railway.app](https://railway.app)
   - Conecte sua conta GitHub
   - Clique em "New Project" ‚Üí "Deploy from GitHub repo"
   - Selecione seu reposit√≥rio

3. **Configurar Vari√°veis de Ambiente**
   ```
   OPENAI_API_KEY=sua_chave_openai
   GOOGLE_DRIVE_FOLDER_ID=id_da_pasta
   CONTENT_GENERATION_INTERVAL=4
   LOG_LEVEL=INFO
   TZ=America/Sao_Paulo
   ```

4. **Deploy Autom√°tico**
   - Railway detecta o Dockerfile automaticamente
   - O deploy acontece a cada push no GitHub

### 2. Render

**Vantagens:**
- 750 horas gratuitas por m√™s
- Deploy cont√≠nuo via GitHub
- SSL autom√°tico
- Logs detalhados

**Limita√ß√µes:**
- Servi√ßo "hiberna" ap√≥s 15 minutos de inatividade
- Recursos limitados no plano gratuito

**Passos para Deploy:**

1. **Criar conta no Render**
   - Acesse [render.com](https://render.com)
   - Conecte sua conta GitHub

2. **Criar Web Service**
   - New ‚Üí Web Service
   - Conecte seu reposit√≥rio GitHub
   - Configura√ß√µes:
     - Build Command: `pip install -r requirements.txt`
     - Start Command: `python automation_scheduler.py`

3. **Configurar Vari√°veis**
   - Adicione as mesmas vari√°veis do Railway

### 3. Heroku (Com Limita√ß√µes)

**Vantagens:**
- Plataforma madura e est√°vel
- Boa documenta√ß√£o
- Add-ons dispon√≠veis

**Limita√ß√µes:**
- Plano gratuito foi descontinuado
- Planos pagos a partir de $7/m√™s

**Alternativa:** Usar cr√©ditos gratuitos para estudantes ou promo√ß√µes

### 4. Google Cloud Run

**Vantagens:**
- 2 milh√µes de requests gratuitos por m√™s
- Escalabilidade autom√°tica
- Integra√ß√£o nativa com Google Drive

**Limita√ß√µes:**
- Configura√ß√£o mais complexa
- Requer cart√£o de cr√©dito para verifica√ß√£o

**Deploy via Cloud Run:**

1. **Instalar Google Cloud SDK**
   ```bash
   curl https://sdk.cloud.google.com | bash
   gcloud auth login
   gcloud config set project SEU_PROJECT_ID
   ```

2. **Build e Deploy**
   ```bash
   gcloud run deploy day-trade-generator \
     --source . \
     --platform managed \
     --region us-central1 \
     --allow-unauthenticated
   ```

### 5. Fly.io

**Vantagens:**
- Recursos generosos no plano gratuito
- Deploy global
- Suporte completo ao Docker

**Limita√ß√µes:**
- Requer cart√£o de cr√©dito
- Complexidade m√©dia de configura√ß√£o

## Configura√ß√£o Recomendada

### Para M√°xima Confiabilidade

**Op√ß√£o 1: Railway + GitHub Actions**
```yaml
# .github/workflows/deploy.yml
name: Deploy to Railway
on:
  push:
    branches: [main]
  schedule:
    - cron: '0 */6 * * *'  # Backup a cada 6 horas

jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      - name: Deploy to Railway
        run: |
          # Script de deploy
```

**Op√ß√£o 2: M√∫ltiplos Servi√ßos (Redund√¢ncia)**
- Railway como principal
- Render como backup
- Webhook para sincroniza√ß√£o

### Monitoramento e Alertas

**UptimeRobot (Gratuito)**
- Monitora at√© 50 servi√ßos
- Alertas por email/SMS
- Dashboard p√∫blico

**Configura√ß√£o:**
1. Adicione a URL do seu servi√ßo
2. Configure alertas para downtime
3. Monitore o endpoint `/health`

## Scripts de Automa√ß√£o

### Deploy Script
```bash
#!/bin/bash
# deploy.sh

echo "üöÄ Iniciando deploy..."

# Build da imagem Docker
docker build -t day-trade-generator .

# Tag para registry
docker tag day-trade-generator registry.railway.app/day-trade-generator

# Push para Railway
docker push registry.railway.app/day-trade-generator

echo "‚úÖ Deploy conclu√≠do!"
```

### Health Check Script
```bash
#!/bin/bash
# health_check.sh

URL="https://seu-app.railway.app/health"
RESPONSE=$(curl -s -o /dev/null -w "%{http_code}" $URL)

if [ $RESPONSE -eq 200 ]; then
    echo "‚úÖ Servi√ßo est√° funcionando"
else
    echo "‚ùå Servi√ßo com problemas: HTTP $RESPONSE"
    # Enviar alerta
fi
```

## Otimiza√ß√µes para Servidores Gratuitos

### 1. Reduzir Uso de Recursos

```python
# Otimiza√ß√µes no c√≥digo
import gc
import time

def optimize_memory():
    """Libera mem√≥ria n√£o utilizada"""
    gc.collect()
    time.sleep(1)

# Usar ap√≥s opera√ß√µes pesadas
optimize_memory()
```

### 2. Cache Inteligente

```python
# Cache de prompts para reduzir calls da API
PROMPT_CACHE = {}

def get_cached_prompt(key):
    if key in PROMPT_CACHE:
        return PROMPT_CACHE[key]
    # Gerar novo prompt
    return new_prompt
```

### 3. Configura√ß√£o de Logging

```python
# Logs otimizados para produ√ß√£o
import logging

logging.basicConfig(
    level=logging.INFO,
    format='%(asctime)s - %(levelname)s - %(message)s',
    handlers=[
        logging.StreamHandler(),  # Console apenas
        # Evitar arquivos de log em disco
    ]
)
```

## Troubleshooting

### Problemas Comuns

**Servi√ßo para ap√≥s algumas horas:**
- Verificar limites do plano gratuito
- Implementar keep-alive ping
- Usar m√∫ltiplos servi√ßos

**Erro de mem√≥ria:**
- Reduzir n√∫mero de imagens simult√¢neas
- Implementar garbage collection
- Otimizar imports

**API rate limiting:**
- Implementar backoff exponencial
- Cache de resultados
- Distribuir requests no tempo

### Logs e Debugging

**Acessar logs no Railway:**
```bash
railway logs
```

**Acessar logs no Render:**
- Dashboard ‚Üí Service ‚Üí Logs

**Debug local:**
```bash
docker-compose up --build
```

## Custos Estimados

### Planos Gratuitos
- **Railway**: Gratuito (500h/m√™s)
- **Render**: Gratuito (750h/m√™s)
- **Google Cloud**: Gratuito (2M requests/m√™s)

### APIs Utilizadas
- **OpenAI**: ~$0.36/m√™s (180 execu√ß√µes)
- **Google Drive**: Gratuito
- **Pollinations**: Gratuito

**Total estimado: $0.36/m√™s**

## Pr√≥ximos Passos

1. **Escolher plataforma** baseada nas suas necessidades
2. **Configurar reposit√≥rio** GitHub com o c√≥digo
3. **Fazer deploy inicial** e testar funcionamento
4. **Configurar monitoramento** para garantir uptime
5. **Otimizar performance** baseado nos logs
6. **Implementar backups** autom√°ticos

---

**Recomenda√ß√£o Final:** Use Railway para come√ßar devido √† simplicidade e recursos adequados. Configure monitoramento desde o in√≠cio para garantir que o sistema funcione 24/7 conforme esperado.
